    Данное веб приложение является простейшей реализацией менеджера дохода, реализованное с использованием docker, nginx, postgres, flask

Данное приложение поддерживает два действия.
1) Посчитать совокупный доход за указанный промежуток времени
2) Добавить информацию о доходе

Оба этих действия можно сделать через веб интерфейс, например, открыв в браузере http://localhost:1337

Сервис состоит из нескольких компонент, каждая из которых запускается в отдельном контейнере
1) web
    Бэкенд, реализованный с помощью flask. Имеет две ручки, позволяющие получить доход за указанный промежуток и сохранить конкертную статью дохода в определенный день. Доход может быть отрицательным.

2) nginx
    Здесь развернута прокси, редиректящая запросы в веб сервер.

3) postgres
    Здесь развернута база, редиректящая запросы в веб сервер.


Собрать образы:
`docker compose build`

Запустить контейнеры:
`docker compose up -d`

Остановить контейнеры:
`docker compose down`

Остановить контейнеры и почистить вольюмы:
`docker compose down -v`



## Использование k8s с minikube

* Собрать образы
`(eval $(minikube docker-env) &&  docker compose build)`

* Запустить
`kubectl apply -f ./k8s/env-dev-configmap.yaml,./k8s/postgres-data-persistentvolumeclaim.yaml,./k8s/db-service.yaml,./k8s/web-service.yaml,./k8s/db-deployment.yaml,./k8s/web-deployment.yaml`

* Ждем пока все поды поднимутся (должен быть статус RUNNING)
`kubectl get pods -w`

* Настраиваем port-forward для доступа до сервиса
`kubectl port-forward --address 0.0.0.0 $(echo $(echo $(kubectl get pods -A | grep web) | cut -d ' ' -f 2)) 30007:5000`

* Теперь к приложению есть доступ из браузера по ссылке http://localhost:30007/

* Чтобы удалить поды
`kubectl delete -f ./k8s/env-dev-configmap.yaml,./k8s/postgres-data-persistentvolumeclaim.yaml,./k8s/db-service.yaml,./k8s/web-service.yaml,./k8s/db-deployment.yaml,./k8s/web-deployment.yaml`
